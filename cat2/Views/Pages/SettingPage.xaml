<Page
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vm="clr-namespace:CAT2.ViewModels"

    x:Class="CAT2.Views.Pages.SettingPage">

    <Page.DataContext>
        <vm:SettingPageViewModel />
    </Page.DataContext>

    <StackPanel
        Margin="15"
        Orientation="Vertical">
        <Label
            Margin="5"
            FontWeight="Bold"
            Content="设置" />

        <ui:CardExpander
            Padding="14"
            Margin="0,0,0,5">
            <ui:CardExpander.Icon>
                <ui:SymbolIcon
                    Symbol="DocumentTextClock24" />
            </ui:CardExpander.Icon>
            <ui:CardExpander.Header>
                <Grid>
                    <TextBlock>
                        <Run
                            Text="隧道日志记录" />
                        <LineBreak />
                        <Run
                            FontSize="14"
                            Text="查看日志记录或清除它。"
                            Foreground="{ui:ThemeResource TextFillColorDisabledBrush}" />
                    </TextBlock>

                    <Button
                        Margin="0,0,10,0"
                        HorizontalAlignment="Right"
                        Command="{Binding OpenDataPathCommand}"
                        Content="打开文件夹" />
                </Grid>
            </ui:CardExpander.Header>

            <MenuItem
                FontSize="18"
                Header="清除隧道日志缓存"
                Icon="{ui:SymbolIcon CommentOff24}"
                IsEnabled="{Binding IsClearedEnabled}"
                Command="{Binding ClearedCommand}" />
        </ui:CardExpander>

        <ui:CardExpander
            Padding="14"
            Margin="0,0,0,5">
            <ui:CardExpander.Icon>
                <ui:SymbolIcon
                    Symbol="DocumentTextExtract24" />
            </ui:CardExpander.Icon>
            <ui:CardExpander.Header>
                <Grid>
                    <ui:TextBlock>
                        <Run
                            Text="隧道自启动" />
                        <LineBreak />
                        <Run
                            FontSize="14"
                            Text="当转到管理隧道页时自启动选好的隧道。"
                            Foreground="{ui:ThemeResource TextFillColorDisabledBrush}" />
                    </ui:TextBlock>

                    <Button
                        Margin="0,0,10,0"
                        HorizontalAlignment="Right"
                        Command="{Binding WriteSettingsCommand}"
                        Content="保存配置" />
                </Grid>
            </ui:CardExpander.Header>

            <Grid>
                <Label
                    Visibility="{Binding LabelVisibility}"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Bottom"
                    Content="暂无隧道请注册。" />

                <ui:ListView
                    Visibility="{Binding ListVisibility}"
                    ItemsSource="{Binding AutoStartedItems}">
                    <ui:ListView.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <TextBlock
                                    VerticalAlignment="Center"
                                    Text="{Binding Name}"
                                    HorizontalAlignment="Left" />
                                <CheckBox
                                    HorizontalAlignment="Right"
                                    IsChecked="{Binding IsStarted}" />
                            </Grid>
                        </DataTemplate>
                    </ui:ListView.ItemTemplate>
                </ui:ListView>
            </Grid>
        </ui:CardExpander>

        <Label
            Margin="5"
            FontWeight="Bold"
            Content="关于" />

        <ui:CardExpander
            Padding="14">
            <ui:CardExpander.Icon>
                <ui:ImageIcon
                    Height="25"
                    Source="pack://application:,,,/logo.ico" />
            </ui:CardExpander.Icon>
            <ui:CardExpander.Header>
                <Grid>
                    <ui:TextBlock
                        TextWrapping="WrapWithOverflow">
                        <Run
                            Text="{Binding AssemblyName}" />
                        <LineBreak />
                        <Run
                            Foreground="{ui:ThemeResource TextFillColorDisabledBrush}"
                            Text="{Binding Copyright}"
                            FontSize="14" />
                    </ui:TextBlock>

                    <Label
                        Margin="10"
                        Foreground="{ui:ThemeResource TextFillColorDisabledBrush}"
                        HorizontalAlignment="Right"
                        ToolTip="{Binding FileVersion}"
                        Content="{Binding Version}" />
                </Grid>
            </ui:CardExpander.Header>

            <StackPanel>
                <TextBlock
                    Margin="0,0,0,8"
                    TextWrapping="WrapWithOverflow"
                    Text="我是Qusay，目前是一名初中生，正在编写此应用程序。QQ:2976779544" />

                <StackPanel
                    Orientation="Horizontal">
                    <ui:HyperlinkButton
                        Icon="{ui:SymbolIcon Link48}"
                        Content="查看作者BiliBili首页"
                        Padding="8"
                        NavigateUri="https://space.bilibili.com/1582404131"
                        Margin="0,0,10,0" />

                    <ui:HyperlinkButton
                        Icon="{ui:SymbolIcon Link48}"
                        Content="查看Github项目"
                        Padding="8"
                        NavigateUri="https://cat2.chmlfrp.com"
                        ToolTip="Github可能访问不上(⊙﹏⊙)" />
                </StackPanel>
            </StackPanel>
        </ui:CardExpander>
    </StackPanel>
</Page>